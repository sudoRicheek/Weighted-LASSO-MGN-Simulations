# Group-Testing

Code for some of the algorithms used in the following papers:

[1] R. Goenka, S.-J. Cao, C.-W. Wong, A. Rajwade and D. Baron, "Contact Tracing Enhances the Efficiency of Covid-19 Group Testing," ICASSP 2021 - 2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), 2021, pp. 8168-8172, doi: 10.1109/ICASSP39728.2021.9414034.

[2] R. Goenka, S.-J. Cao, C.-W. Wong, A. Rajwade and D. Baron, "Contact tracing enhances the efficiency of covid-19 group testing," arXiv preprint arXiv:2011.14186, 2020.

[3] S. Ghosh et al., "A Compressed Sensing Approach to Pooled RT-PCR Testing for COVID-19 Detection," in IEEE Open Journal of Signal Processing, doi: 10.1109/OJSP.2021.3075913.

## Directory Layout

* `Infection Spread Model`: Code for simulating infection spread and example data 
  * `Data Generation`: Simulate COVID-19 infection spread using SEIR-style model
  * `Data`: Data generated using generation algorithms
* `Pooling Matrix Design`: Code for generating various kinds of pooling matrices and example matrices
  * `Balanced Binary Matrices`: Balanced binary matrices - random, mutual coherence, side information
  * `Devore's Matrices`: Devore's deterministic sensing matrix design
  * `Kirkman matrices`: Kirkman matrices of sprecific dimensions
* `Testing Algorithms`: Code for various group testing algorithms
  * `comp_nnlasso.m`: COMP NNLASSO algorithm
  * `all_algorithms.m`: All group testing algorithms - COMP, COMP NNLASSO, COMP SQRT GLASSO, COMP SQRT OGLASSO
  * `all_algorithms_general.m`: All group testing algorithms with the contact tracing graph having incomplete cliques
  * `Helper Functions`: Helper functions for the testing algorithms
    * `l1_ls_nonneg.m`: Function to solve the l1-regularized least squares problem
    * `maximalCliques.m`: Function to find maximal cliques in a graph based on the Bron-Kerbosch algorithm
* `Example Experiment`: An example experimental setup to run experiments for M2 as in [1, Sec. 4]
  * `Inference`: Run all algorithms with the option to choose pooling matrix and simulation data 
  * `Logs`: Matlab logs for experimental runs
  * `Results`: Results stored in .mat files and details of false negatives and positives in .txt files
* `Plotting`: Utility scripts in python for generating figures in our papers
  * `Bar Graph Example`: Bar graphs as in [1, Fig. 3]
  * `Heat Map Example`: Heat maps as in [2, Fig. 7]
  * `Matrix Visualization`: Binary matrix diagrams as in [2, Fig. 11] and [3, Fig. 1]

## Some Remarks

* `Infection Spread Model/Data` contains eight data files, four corresponding to the data used for experiments in [1, Sec. 4] and four corresponding to the data used for experiments in [2, Supplementary Sec. 4].
* `Pooling Matrix Design/Kirkman Matrices` contains code for manual Kirkman designs of very specific fixed dimensions. See https://github.com/ssgosh/group-test for code to generate Kirkman matrices with a wide range of dimensions.
* `Testing Algorithms/comp_nnlasso.m` provides an option to switch on 2-means clustering to determine the viral load threshold tau for declaring samples positive.
* `Testing Algorithms/all_algorithms.m` provides an option to incorporate side information in the pooling matrix.
* The log and result files in `Example Experiment/Logs` and `Example Experiment/Results` were generated by running the following command from the directory `Example Experiment/Inference`:

    ```
    nohup matlab -nosplash -nodisplay -nodesktop -r 'clear;clc;close all;dat_index = 1;mat_index = 1;inference' > ../Logs/log_11.txt &
    ```
    The variables `dat_index` and `mat_index` specify the index of the simulation data and pooling matrix, respectively, in the lists specified in `Example Experiment/Inference/inference.m`.
